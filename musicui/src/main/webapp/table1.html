<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title> - 数据表格</title>
    <meta name="keywords" content="">
    <meta name="description" content="">

    <link rel="shortcut icon" href="favicon.ico"> <link href="css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="css/font-awesome.css?v=4.4.0" rel="stylesheet">

    <!-- Data Tables -->
    <link href="css/plugins/dataTables/dataTables.bootstrap.css" rel="stylesheet">

    <link href="css/animate.css" rel="stylesheet">
    <link href="css/style.css?v=4.1.0" rel="stylesheet">

</head>
<STYLE>
     .input-group{
         width: 260px;
         margin: 0 auto;
     }
    .modal-dialog{
        width: 400px;
    }
</STYLE>
<body class="gray-bg">
    <div class="wrapper wrapper-content animated fadeInRight">
        <div class="row">
            <div class="col-sm-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>基本 <small>分类，查找</small></h5>
                        <div class="ibox-tools">
                            <a class="collapse-link">
                                <i class="fa fa-chevron-up"></i>
                            </a>
                            <a class="dropdown-toggle" data-toggle="dropdown" href="table_data_tables.html#">
                                <i class="fa fa-wrench"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-user">
                                <li><a href="table_data_tables.html#">选项1</a>
                                </li>
                                <li><a href="table_data_tables.html#">选项2</a>
                                </li>
                            </ul>
                            <a class="close-link">
                                <i class="fa fa-times"></i>
                            </a>
                        </div>
                    </div>
                    <div class="ibox-content">
                        <table class="table table-striped table-bordered table-hover dataTables-example">
                            <thead>
                                <tr>
                                    <th>userid</th>
                                    <th>账号</th>
                                    <th>用户名</th>
                                    <th>性别</th>
									<th>年龄</th>
									<th>电话</th>
									<th>邮箱</th>
                                    <th>编辑</th>
                                </tr>
                            </thead>
                            <tbody id="user-contenr">
                            </tbody>
                            <tbody>
                                 <tr>
                                    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal-add">增加用户</button>
                                 </tr>
                                 <tr>
                                         <input style="margin-left: 150px" type="text" id="serach">
                                         <button type="button" class="btn btn-primary" onclick="loadSingerData(1)">搜索</button>

                                 </tr>
                            </tbody>
                        </table>
                        <div id="pagerutil" class="fenye" style="height:30px; font-size: 15px">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal inmodal" id="myModal-editor" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content animated bounceInRight">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">关闭</span>
                    </button>
                    <h6 class="modal-title">修改用户</h6><br>
                </div>
                <div class="modal-body">

                    <div class="input-group">
                        <span class="input-group-addon">ID</span>
                        <input type="text" class="form-control" id="euserid">
                    </div><br>

                    <div class="input-group">
                        <span class="input-group-addon">账号</span>
                        <input type="text" class="form-control" id="eaccounts">
                    </div><br>

                    <div class="input-group">
                        <span class="input-group-addon">用户名</span>
                        <input type="text" class="form-control" id="eusername">
                    </div><br>

                    <div class="input-group">
                        <span class="input-group-addon">性别</span>
                        <input type="text" class="form-control" id="esex">
                    </div><br>

                    <div class="input-group">
                        <span class="input-group-addon">年龄</span>
                        <input type="text" class="form-control" id="eage">
                    </div><br>

                    <div class="input-group">
                        <span class="input-group-addon">电话</span>
                        <input type="text" class="form-control" id="etelephone">
                    </div><br>

                    <div class="input-group">
                        <span class="input-group-addon">邮箱</span>
                        <input type="text" class="form-control" id="eemail">
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="editorbtn()">确认修改</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal inmodal" id="myModal-add" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content animated bounceInRight">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">关闭</span>
                    </button>
                    <h6 class="modal-title">添加用户</h6><br>
                </div>
                <div class="modal-body">
                    <div class="input-group">
                        <span class="input-group-addon">账号</span>
                        <input type="text" class="form-control" id="addaccounts">
                    </div><br>

                    <div class="input-group">
                        <span class="input-group-addon">用户名</span>
                        <input type="text" class="form-control" id="addusername">
                    </div><br>

                    <div class="input-group">
                        <span class="input-group-addon">密码</span>
                        <input type="text" class="form-control" id="adduserpwd" >
                    </div><br>

                    <div class="input-group">
                        <span class="input-group-addon">性别</span>
                        <input type="text" class="form-control" id="addsex">
                    </div><br>

                    <div class="input-group">
                        <span class="input-group-addon">年龄</span>
                        <input type="text" class="form-control" id="addage">
                    </div><br>

                    <div class="input-group">
                        <span class="input-group-addon">电话</span>
                        <input type="text" class="form-control" id="addtelephone">
                    </div><br>

                    <div class="input-group">
                        <span class="input-group-addon">邮箱</span>
                        <input type="text" class="form-control" id="addemail">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="addUser()">确认添加</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 全局js -->
    <script src="js/jquery.min.js?v=2.1.4"></script>
    <script src="js/bootstrap.min.js?v=3.3.6"></script>
    <script src="js/plugins/jeditable/jquery.jeditable.js"></script>
    <!-- Data Tables -->
    <script src="js/plugins/dataTables/jquery.dataTables.js"></script>
    <script src="js/plugins/dataTables/dataTables.bootstrap.js"></script>
    <!-- 自定义js -->
    <script src="js/content.js?v=1.0.0"></script>

    <script>
        function loadSingerData(indexpage){
            var uname=$("#serach").val();
            $.post(
                "http://localhost:8080/adminuser.do",
                {indexpage:indexpage,uname:uname},
                function (data) {
                    var tr_item=$("#user-contenr");
                    tr_item.empty();
                    for (var i=0;i<data.data.data.length;i++) {
                        var item=" <tr class=\"gradeX\" >\n" +
                            "                                    <td>"+data.data.data[i].userid+"</td>\n" +
                            "                                    <td>"+data.data.data[i].accounts+"</td>\n" +
                            "                                    <td>"+data.data.data[i].username+"</td>\n" +
                            "                                    <td class=\"center\">"+data.data.data[i].sex+"</td>\n" +
                            "\t\t\t\t\t\t\t\t\t<td class=\"center\">"+data.data.data[i].age+"</td>\n" +
                            "\t\t\t\t\t\t\t\t\t<td class=\"center\">"+data.data.data[i].telephone+"</td>\n" +
                            "\t\t\t\t\t\t\t\t\t<td class=\"center\">"+data.data.data[i].email+"</td>\n" +
                            "\t\t\t\t\t\t\t\t\t<td class=\"center\">" +
                            "<button  type=\"button\" class=\"btn btn-primary\" data-toggle=\"modal\" data-target=\"#myModal-editor\" onclick=\"editoruser("+data.data.data[i].userid+")\">修改</button>" +
                            "\t\t\t\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-primary\" onclick=\"deleteuser("+data.data.data[i].userid+")\">删除</button></td>\n" +
                            "                                </tr>"
                        tr_item.append(item);
                    }

                    $("#pagerutil").empty();

                    var pager = " <a href=\"#\" onclick=\"loadSingerData(1)\" style=\"\">首页</a>\n" +
                        "            <a href=\"#\" onclick=\"loadSingerData("+(data.data.indexpage-1)+")\" style=\"\">上页</a>\n" +
                        "            <a href=\"#\" style=\"\">"+data.data.indexpage+"/"+data.data.countpage+"</a>\n" +
                        "            <a href=\"#\" onclick=\"loadSingerData("+(data.data.indexpage+1)+")\" style=\"\">下页</a>\n" +
                        "            <a href=\"#\" onclick=\"loadSingerData("+(data.data.countpage)+")\" style=\"\">尾页</a>";
                    $("#pagerutil").append(pager);
                }
            );
        }

        function deleteuser(userid){
            $.post(
                "http://localhost:8080/deleteuser.do",
                {userid:userid},
                function (data) {
                    alert(data.msg);
                    window.location.reload();
                }
            )
        }

        function addUser(){
            var accounts=$("#addaccounts").val();
            var username=$("#addusername").val()
            var userpwd=$("#adduserpwd").val()
            var age=$("#addage").val()
            var sex=$("#addsex").val()
            var telephone=$("#addtelephone").val()
            var email=$("#addemail").val()
            if (accounts==""||username==""||userpwd==""||age==""||sex==""||telephone==""||email==""){
                alert("所有选项都不能为空")
            }else{
                $.post(
                    "http://localhost:8080/adduser.do",
                    {accounts:accounts,username:username,userpwd:userpwd,age:age,sex:sex,telephone:telephone,email:email,},
                    function (data) {
                        alert(data.msg);
                        window.location.reload();
                    }
                )
            }
        }
        function editoruser(userid){
            $.post(
                "http://localhost:8080/selectUserByid.do",
                {userid:userid},
                function (data){
                    $("#euserid").val(data.data[0].userid);
                   $("#eaccounts").val(data.data[0].accounts);
                   $("#eusername").val(data.data[0].username);
                   $("#euserpwd").val(data.data[0].userpwd);
                   $("#esex").val(data.data[0].sex);
                   $("#eage").val(data.data[0].age);
                   $("#etelephone").val(data.data[0].telephone);
                   $("#eemail").val(data.data[0].email);
                    $("#euserid").attr("disabled","flase");
                    $("#euserpwd").attr("disabled","flase");
                    $("#eaccounts").attr("disabled","flase");
                }
            )
        }

        function editorbtn(){
            var userid=$("#euserid").val()
            var accounts= $("#eaccounts").val();
            var username=$("#eusername").val();
            var userpwd=$("#euserpwd").val();
            var sex= $("#esex").val();
            var age= $("#eage").val();
            var telephone= $("#etelephone").val();
            var email= $("#eemail").val();
            $.post(
                "http://localhost:8080/editoruser.do",
                {userid:userid,accounts:accounts,username:username,userpwd:userpwd,sex:sex,age:age,telephone:telephone,email:email},
                function (data){
                   alert(data.msg);
                   window.location.reload();
                }
            )
        }
        $(function(){
            loadSingerData(1);
        });
    </script>
</body>
</html>
